
* Reviewer A

** line 27â€”83. This only rehashes known ideas. Can you make it shorter?
   Or, best, begin by describing a new idea.

** line 84â€”104. This makes heavy going of introducing a few basic ideas.
   And says nothing very useful to the reader, since neither â‡“ nor â‰¡
   is defined. This explanation probably belongs later in the
   introduction.

** line 91. â€œFirst, it should be adequate: natural number constants should
   step to themselves.â€  This is a highly limited notion of adequacy,
   I donâ€™t recall seeing it defined this way before. Also, here you
   use â€œstepâ€ for â€œbig stepâ€, which confused me because I usually take
   it to mean â€œsmall stepâ€. Perhaps â€œstepâ€ â€”> â€œevaluateâ€

** line 99. â€œğ‘€ â‡“ ğ‘› <=> ğ‘ â†“ ğ‘›â€ â€”> â€œğ‘€ â‡“ ğ‘› <=> ğ‘ â‡“ ğ‘›â€

** line 127â€”129. â€œdomain theory is incapable of modeling certain perversely
   recursive features of programming languages such as dynamic type
   tag generation and higher-order referencesâ€ Why is type tag
   generation â€œperversely recursiveâ€? Higher-order references are
   quite commonâ€”give an intuition as to why they cannot be handled in
   domain theory.

** line 135â€”136. â€œbut more commonly as â€œstep-indexed setsâ€â€ Step-indexing
   appears often in works on gradual typing (e.g., in all the work on
   gradual typing and parametricity), and I always find it immensely
   difficult to follow. It also feels quite syntactic in nature. So if
   you can give a disciplined and semantic approach to step-indexing
   that is immediately appealing (to this reader at least). Perhaps
   you might focus on this more in your introduction and motivation?

** line 157. â€œBecause bisimilarity, unlike equality, is not transitiveâ€
   Provide intuition as to why this is true and/or promise more
   details later.

** line 166. â€œis as simple as a semanticsâ€ [garbled]
   â€”> â€œis as simple as giving a semanticsâ€ [or similar]

** line 169. â€œwould require significant theory of presheavesâ€ [garbled]
   â€”> â€œwould require a significant theory of presheavesâ€ [or similar]

** line 176. â€œcompatible with the restriction mapsâ€
   You havenâ€™t mentioned restriction maps before. Please introduce
   terms before use!

** line 182. â€œ{ğ‘‹_n} â€“ a family of elements ğ‘¥ âˆˆ ğ‘‹ for all ğ‘– âˆˆ Nâ€
   You defined X_n earlier, and {X_n} looks like a singleton set of
   one of these. But I think what you have in mind is what I might
   write as {x_i | x_i \in X_i, i \in Nat} or similar. Perhaps use
   that notation again?

** line 182. â€œthe presheaf {ğ‘‹_n}â€
   You just made a point of saying that one of the advantages of your
   approach is that you donâ€™t need presheafs. That was a relief to me,
   because even though I know a fair bit of domain theory and category
   theory Iâ€™ve never understood presheafs. Can you write your paper so
   it is easily read by someone who has never head of presheafs? (That
   doesnâ€™t rule out having a few parenthetic remarks addressed to
   readers who know about presheafs, connecting what you are saying to
   the theory they are already familiar with.)

** line 199 â€œA great deal of the work has further been verified in Guarded Cubical Agdaâ€
   I take it that means not everything has been verified. Explain what
   has not been verified, and why not. [I see later this is discussed
   in Section 6.2, so a forward pointer there will do.]

** line 197â€”229. You have two numbered lists.
   Are these in one-to-one correspondence, i.e. point (1) or the first
   list is dealt with in point (1) of the second, and the same for (2)
   through (5)? If so, make that clear. If not, perhaps label the
   first list (a), (b), â€¦ and the second (1), (2), â€¦ to emphasise the
   lack of correspondence.

** line 197â€”229. Earlier, you mentioned bisimilarity as important.
   Shouldnâ€™t it also appear somewhere in this summary?

** line 244. â€œas well as monotonicityâ€ [garbled] â€”> â€œas well asâ€

** Figure 1. The formulation you give is non-standard. A more common one is

     ...

   In this system, both reflexivity and transitivity can be
   derived. Every inequation has a unique derivation, so you donâ€™t need
   any equations relating derivations. I presume you have a good reason
   for using your formulation instead of this one, but you should say
   what it is!

** line 292â€”314. In the introduction, summarise why errors and divergence must arise,
   and give a forward pointer to here for details.

** line 350. â€œIn particular, this axiom applies to propositions P : Prop;
   proving a statement in this manner is known as Lob-induction.â€  â€”>
   â€œIn particular, fix applies when type T is instantiated to a
   proposition P : Prop; in that case, it corresponds to
   Lob-induction.â€

** line 366 â€œto apply M to tick t, M must beâ€
   â€”> â€œto apply M to tick t, then M must beâ€ Symbols in different
   formulas must be separated by words (to give the poor reader a
   clear indication of where one formula ends and the next
   begins). [See Knuth, Mathematical Writing, page 1, rule 1.]

** line 440 Footnote 4 is incomplete.
   â€œthe ğœƒ structure is not algebraic in the strictest sense since it
   does not have finite arity, butâ€

** line 530. â€œThe full definitions of the Kleisli actions are included in Appendix ??.â€
   Dangling reference.

** line 542. â€œdefine a functionâ€
   â€”> â€œdefine a partial functionâ€

** line 551. â€œthe type ğ´ğ‘”ğ‘™â€ Tell the reader what â€œglâ€ stands for.
   [At line 1109 it becomes clear it means â€œglobalâ€ but that is rather
   a long time for the poor reader to wait!]

** line 563. â€œWe can define a notion of termination in ğ‘– steps for the Delay monad ğ‘‘ â†“ğ‘– ğ‘›â€
   Donâ€™t just say you can define it, actually define it. I presume you
   mean that n is whatever number d converges to in i steps, or is
   error if d doesnâ€™t converge in i steps, but you ought to say so.
*** ERIC: Should I define this explicitly or is it obvious enough?

** line 564. â€œFrom this, can define a partial functionâ€
   â€”> â€œFrom this, we can define a partial functionâ€ But again, donâ€™t
   claim you can define it, actually do so.
*** ERIC: Same as above.

** line 554â€”570. You never give a hint as to why clocks need to be introduced in this section.
    Please explain!
*** ERIC: The second paragraph discusses clocks and why we need to use them.
    I'm not sure what more there is to be said. Maybe we could link
    back to the informal discussion of global solutions given in the
    introduction.

** line 608. â€œjust when they are in the ordering âŠ‘ on ğ´â€
   Actually, Figure 4 uses â‰¤ not âŠ‘.

** line 613 "final 4 casesâ€ 
   â€”> â€œfinal three casesâ€ It is usually good style to spell out any
   number ten or smaller.

** line 647â€”648. â€œrelations between the underlying sets of ğ´, ğ´â€²  
   that are downward-closed in ğ´ and upward-closed in ğ´â€²â€ Add a
   sentence to explain the requirement for downward and upward
   closure.
*** ERIC: Should we add this?


** line 656. â€œwhere ğ‘ˆğ¿â„§âŸ¦ğ‘âŸ§ is a relational lifting of ğ‘ˆ â—¦ğ¿â„§â€ 
   Spell this out in bit more detail. Did you mean â€œa relational
   lifting of ğ‘ˆ â—¦ğ¿â„§ over âŸ¦ğ‘âŸ§â€ or something else?
*** ERIC: This isn't introduced until later in the paper (line 769).
    At this point, we could say that it is "a lifting of the relation
    âŸ¦ğ‘âŸ§ that accounts for error and stepping"
    

** line 676. Horizontal identity. Please give the definitions of \leg A_i and \leq A_o.
*** ERIC: These should be r(Aáµ¢) and r(Aâ‚’).

** line 714. â€œwith a dual one related to UpRâ€ 
  Do you really mean dual, in the sense that all the arrows are
  reversed? Thatâ€™s not what I get when I write out what I expect for
  UpR. I think it might be easier on the reader to just give the
  squares for UpL and UpR side by side, and for completeness to also
  give the squares for DnL and DnR side by side.

** line 766. â€œIt is straightforward to prove using LÃ¶b-induction 
  that this relation is reflexive, transitive and anti-symmetric given
  that the underlying relation ğ‘… has those properties.â€ â€”> â€œIt is
  straightforward to prove using LÃ¶b-induction that this relation is
  reflexive, transitive and anti-symmetric given that the underlying
  relation âŠ‘ğ´ has those properties.

** line 769. â€œMore generally we can define a heterogeneous version of this ordering 
  that lifts poset relation ğ‘ : ğ´ âˆ’âˆ’|âˆ’âˆ’ ğ´â€² to a poset relation ğ¿â„§ğ‘ :
  ğ¿â„§ğ´ âˆ’âˆ’|âˆ’âˆ’ ğ¿â„§ğ´â€².â€ Surely the more general definition belongs in this
  paper?
*** ERIC: It's identical to the homogeneous one except for the Î· case,
    where the LHS element comes from A and the RHS comes from A',
    rather than both coming from A.

** [conclusion to Section 4]
  Iâ€™m a bit confused that bisimilarity is reflexive and symmetric but
  not transitive. Intuitively, I think of bisimilarity as â€œequivalent
  when ignoring the number of reduction stepsâ€ and that relationship
  is transitive. So it would be helpful for you to explain how
  bisimilarity differs from the relation I describe.

** line 842. â€œextensional (if ğ‘¥ â‰ˆğ´ ğ‘¥â€², then ğ‘“ (ğ‘¥) â‰ˆğ´â€² ğ‘“ (ğ‘¥â€²)).â€ 
  Is that a good name for this property? Normally, extensionality
  means if f x = g x for all x then f = g, which differs significantly
  from what youâ€™ve written. Wikipedia tells me a relation R is
  compatible if x R y implies (f x) R (f y), so perhaps compatible is
  a better name?
*** ERIC: we can say that "f preserves bisimilarity"

** line 847. â€œ. Likewise for bisimilarity.â€
  â€”> â€œand likewise for bisimilarityâ€.

** line 847. Note that this means that â€œğ‘¥ Ìƒ â‰ˆâ–·A ğ‘¥ Ìƒâ€²â€ does not imply that 
  a x with zero steps relates to xâ€™ with one step, or vice versa; they
  both must have at least one step.
*** ERIC: not sure what this comment means

** line 875. â€œDetails of this construction are in the appendix (Definition ??).â€ 
  I think you need to give the construction in the paper.
*** ERIC: we had discussed this and agreed it was better to put in the appendix. Should I move it?

** line 877â€”879. You need to give the details of these constructions.
*** ERIC: we introduce the concept of square in the previous section. 
    Do we need to spell out the definitions for predomains and error domains?

** line 899â€”900. e_Nat, e_\times, e_\to. I donâ€™t recall where these were defined.
   Please define or give a back reference.

** line 924â€”925. â€œWe define a value morphism to be a morphism of the
  underlying predomains, and a computation morphism to be a morphism
  of the underlying error domains.â€ Is there no requirement to
  preserve anything connected with the monoids M_A and M_B? If so,
  state this explicitly, and in the surrounding text explain why no
  additional constraint is required.

** line 969. â€œpush-pull structureâ€ 
  I suggest adding a parenthetic note to clarify that the â€œpushâ€ here
  has nothing to with the â€œpushâ€ in â€œcall by push valueâ€.

** line 996â€”997. â€œHere ğ‘“ â€² â‰ˆ ^Ao_Ai ğ‘“ is the natural extension of bisimilarity to morphisms: 
  given bisimilar inputs the ğ´ğ‘œ functions have bisimilar outputs.â€ Put
  this definition before Definition 5.11.

** line 1001. Theorem 5.12. This is not really a theorem statement, 
  it is more an informal promise of a program that can be carried
  out. Please rephrase. Give the informal statement of a program as an
  informal statement, and follow it by a formal theorem.

** line 1023â€”1024. â€œwe need a syntactic perturbation in ğ‘€ğ¿â„§ğ´ 
  that will be interpreted as (ğ›¿ â—¦ ğœ‚)â€ . We accomplish this by taking
  the coproduct with N.â€ I donâ€™t see where N comes in. Was ğ›¿ meant to
  be ğ›¿^n.
*** ERIC: Need to be more explicit about why we take the coproduct with N,
    i.e. the fact that N is the free monoid on one generator, and the
    generator is interpreted as the delay perturbation (ğ›¿ â—¦ ğœ‚)â€ .

** line 1026. â€œ(see appendix for details)â€ 
  This seems to be a detail that should be in the paper, not an appendix.
*** ERIC: Should we move these details to the body of the paper?

** line 1031. â€œSince the perturbations for ğ¿â„§ğ´ involve N, 
  so must the perturbations for ğ‘ˆ ğµ. The interpretation ğ‘– ğ‘ˆğµ of the
  perturbations on ğ‘ˆ ğµ works in the same manner as that of ğ¿â„§ğ´.â€ This
  is great for motivating the construction, but you should also give
  the construction.

** line 1036. â€œ(see appendix for the details)â€ See 1026.

** line 1038. Here M_A is a monoid, so Iâ€™m not clear on how M^op_A differs from M_A.

** line 1059â€”1061. You give homomorphisms for products and functions. 
  Donâ€™t you also need one for naturals?

*** ERIC: No, since the monoid of perturbations for natural numbers is trivial.
    But should we mention this in the paper?

** line 1084â€”1085. â€œand that quasi-equivalence impliesâ€ [garbled] 
  â€”> â€œand quasi-equivalence impliesâ€ [or similar]

** line 1089â€”1092. A hint as to why the leftmost vertical looks as it does 
  (the same two downarrow related by â‰ˆ) would be welcome. And, again,
  Iâ€™m not sure where e_c was defined.

** line 1102. Theorem 5.13. The emphasis here on closed terms of type N
  seems misplaced.  Wouldnâ€™t it be better to present a result for open
  terms of any types from which this immediately follows as a
  specialisation?

*** ERIC: Can we extend the big-step term semantics and the adequacy
    theorem to open terms?

** line 1117. â€œğ‘¥ âŠ‘ğ‘”ğ‘™ ğ‘¦ := âˆ€ğ‘˜.ğ‘¥[ğ‘˜] âŠ‘ ğ‘¦[ğ‘˜],â€ I have no idea what x[k] and y[k] mean here. 
  I donâ€™t think that notation appeared previously. (If it did, give a
  back reference to refresh the readerâ€™s memory.)

** line 1120. â€œsee Section ?? in the appendixâ€ Dangling reference.

** line 1145â€”1146. â€œdo not fit into either framework, 
  e.g., Typed Racket [30, 31] and the semantics produced is not always
  the desired oneâ€ â€”> â€œdo not fit into either framework, e.g., Typed
  Racket [30, 31], and the semantics produced is not always the
  desired oneâ€ [Parenthetic phrases should always have a comma on each
  side; see Strunk and White.]

** line 1157. â€œA line of work by New, Licata and Ahmedâ€ 
  You phrase this as if it is unrelated to the previous paragraph, but
  references [23] and [24] are already mentioned there.

** line 1189. â€œThe workâ€ Does this refer to [11] or to your own paper? 
  If the former, better to use â€œhis workâ€, if the latter â€œmy workâ€ or
  â€œour workâ€ or â€œthis workâ€.


* Reviewer B big-picture questions

** First, what does the new denotational semantics for GTLC offer that
   the previous seminal work by New and Licata does not? I see the
   argument in the paper that, due to step-indexing, this new model
   can facilitate extensions with first-class state and other
   features. But, this is a projection to the future. As things are,
   the paper seems to reformulate the previous result (that a
   denotational semantics that has these properties exists for CBV
   GTLC) using a different machinery.

** Second, given that step-indexed logical relations (i) are becoming a
   mainstream tool (ii) thanks to all the work for their
   mechanization, using them and adapting them is significantly easier
   than in the past, and (iii) have already been used extensively to
   develop models for various kinds of gradual types, what are the
   benefits of the papers denotational approach for the gradual typing
   researcher?

** Third, can the new machinery explain the variety of proposals about
   what gradual typing is operationally? Gradual typing is a highly
   diverse and fuzzy notion, but the denotational semantics seem to
   prescribe (axiomatically) a particular way to interpret it. The
   existing variety has sprung out of practical issues (related mainly
   to performance), which are the biggest block for the adoption of
   sound gradual typing. Can the denotational semantics of the paper
   help in this direction in some way?

** Fourth, does the new denotational semantics entail any new design
   principles different than those of the previous work (the validity
   of the two axioms and graduality) that can help those that design
   new gradually typed languages?

** Fifth, is there something new that we learn about gradual typing
   through the lens of the new domain that we didn't know?


* Reviewer B smaller fixes

** line 16: missing ``the'' before gradually

** line 292: missing comma after ``language''

** line 403: redundant ``these in that''

** line 417: \delta --> \delta_B

** line 440: incomplete sentence

** line 480: redundant ``be'' before ``modeled''

** line 531 and through out the paper: missing references to the Appendix

** line 613: ``4'' --> ``2''

** line 639: redundant ``from'

** line 702: redundant ``quantifies''

** line 753: missing space after ``Theorem''

** line 1017: ``we use'' --> ``that use''

** line 1157: missing citation

** line 1197: I think the no-go theorem is in section 4.


* Reviewer C big-picture questions

** The semantics developed isn't used for anything in the paper. 
   The introduction talks about type-based reasoning (line 33, line
   80), but this isn't shown in detail later on in the paper.

** Some of the key ideas (error ordering, the use of double categories)
   are already present in the work of New et al., and one could argue
   that the additional complications of needing a bisimilarity
   relation are self-inflicted by the use of SGDT. On the other hand,
   I think "can we do this in SGDT?" is a good question to ask, as I
   said above.

** Arguably, the authors have chosen a relatively simple part of gradual typing,
   without effects or polymorphism. On the other hand, one has to
   start somewhere, and the combination of errors, non-termination,
   and dynamic types even in the simplest gradual typed system are
   already quite complex.

* Reviewer C smaller fixes

** Throughout there are references to the appendix, but these are all to 'Section/Appendix/Lemma ??'.

** Line 195: could this footnote in inlined into the text?

** Line 440: footnote contains an unfinished sentence.

** Line 485: "homomorphism". 
   I think you refer to these morphisms as "linear" elsewhere, though
   homomorphism is also used on line 403.

** Line 494: I assume [[ A'_o ]] and [[ A_i ]] refer to the identity functions 
   on the interpretations of the respective types?

** Line 627: would it be possible to put more detail about the proof here?
   I feel like there is a simple "key" to this proof that would be
   helpful for the reader to see here.
*** ERIC: Should I give more detail about the proof here?

** Line 927: "quasi-represntability": spelling, and similar on Line 939

** Line 945: "uniqueley"

** Lines 1149-1167: these two paragraphs are talking about the same works by New et al.,
   but seem to have been written independently and then placed next to
   each other?
